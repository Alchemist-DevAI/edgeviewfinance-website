{"version":3,"file":"snippets.js","sources":["../../../src/integration/snippets.ts"],"sourcesContent":["import * as path from 'path';\nimport type { SentryOptions } from './types';\n\n/**\n * Creates a snippet that imports a Sentry.init file.\n */\nexport function buildSdkInitFileImportSnippet(filePath: string): string {\n  return `import \"${pathToPosix(filePath)}\";`;\n}\n\n/**\n * Creates a snippet that initializes Sentry on the client by choosing\n * default options.\n */\nexport function buildClientSnippet(options: SentryOptions): string {\n  return `import * as Sentry from \"@sentry/astro\";\n\nSentry.init({\n  ${buildCommonInitOptions(options)}\n  integrations: [${buildClientIntegrations(options)}],\n  replaysSessionSampleRate: ${options.replaysSessionSampleRate ?? 0.1},\n  replaysOnErrorSampleRate: ${options.replaysOnErrorSampleRate ?? 1.0},\n});`;\n}\n\n/**\n * Creates a snippet that initializes Sentry on the server by choosing\n * default options.\n */\nexport function buildServerSnippet(options: SentryOptions): string {\n  return `import * as Sentry from \"@sentry/astro\";\n\nSentry.init({\n  ${buildCommonInitOptions(options)}\n});`;\n}\n\nconst buildCommonInitOptions = (options: SentryOptions): string => `dsn: ${\n  options.dsn ? JSON.stringify(options.dsn) : 'import.meta.env.PUBLIC_SENTRY_DSN'\n},\n  debug: ${options.debug ? true : false},\n  environment: ${options.environment ? JSON.stringify(options.environment) : 'import.meta.env.PUBLIC_VERCEL_ENV'},\n  release: ${options.release ? JSON.stringify(options.release) : 'import.meta.env.PUBLIC_VERCEL_GIT_COMMIT_SHA'},\n  tracesSampleRate: ${options.tracesSampleRate ?? 1.0},${\n    options.sampleRate ? `\\n  sampleRate: ${options.sampleRate},` : ''\n  }`;\n\n/**\n * We don't include the `BrowserTracing` integration if `bundleSizeOptimizations.excludeTracing` is falsy.\n * Likewise, we don't include the `Replay` integration if the replaysSessionSampleRate\n * and replaysOnErrorSampleRate are set to 0.\n *\n * This way, we avoid unnecessarily adding the integrations and thereby enable tree shaking of the integrations.\n */\nconst buildClientIntegrations = (options: SentryOptions): string => {\n  const integrations: string[] = [];\n\n  if (!options.bundleSizeOptimizations?.excludeTracing) {\n    integrations.push('Sentry.browserTracingIntegration()');\n  }\n\n  if (\n    options.replaysSessionSampleRate == null ||\n    options.replaysSessionSampleRate ||\n    options.replaysOnErrorSampleRate == null ||\n    options.replaysOnErrorSampleRate\n  ) {\n    integrations.push('Sentry.replayIntegration()');\n  }\n\n  return integrations.join(', ');\n};\n\nfunction pathToPosix(originalPath: string): string {\n  return originalPath.split(path.sep).join(path.posix.sep);\n}\n"],"names":[],"mappings":";;AAGA;AACA;AACA;AACO,SAAS,6BAA6B,CAAC,QAAQ,EAAkB;AACxE,EAAE,OAAO,CAAC,QAAQ,EAAE,WAAW,CAAC,QAAQ,CAAC,CAAC,EAAE,CAAC;AAC7C;;AAEA;AACA;AACA;AACA;AACO,SAAS,kBAAkB,CAAC,OAAO,EAAyB;AACnE,EAAE,OAAO,CAAC;;AAEV;AACA,EAAE,EAAE,sBAAsB,CAAC,OAAO,CAAC;AACnC,iBAAiB,EAAE,uBAAuB,CAAC,OAAO,CAAC,CAAC;AACpD,4BAA4B,EAAE,OAAO,CAAC,wBAAA,IAA4B,GAAG,CAAC;AACtE,4BAA4B,EAAE,OAAO,CAAC,wBAAA,IAA4B,GAAG,CAAC;AACtE,GAAG,CAAC;AACJ;;AAEA;AACA;AACA;AACA;AACO,SAAS,kBAAkB,CAAC,OAAO,EAAyB;AACnE,EAAE,OAAO,CAAC;;AAEV;AACA,EAAE,EAAE,sBAAsB,CAAC,OAAO,CAAC;AACnC,GAAG,CAAC;AACJ;;AAEA,MAAM,yBAAyB,CAAC,OAAO,KAA4B,CAAC,KAAK;AACzE,EAAE,OAAO,CAAC,GAAA,GAAM,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,GAAG,CAAA,GAAI;AAC9C,CAAC;AACD,SAAS,EAAE,OAAO,CAAC,KAAA,GAAQ,IAAA,GAAO,KAAK,CAAC;AACxC,eAAe,EAAE,OAAO,CAAC,WAAA,GAAc,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,WAAW,CAAA,GAAI,mCAAmC,CAAC;AACjH,WAAW,EAAE,OAAO,CAAC,OAAA,GAAU,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,OAAO,CAAA,GAAI,8CAA8C,CAAC;AAChH,oBAAoB,EAAE,OAAO,CAAC,oBAAoB,GAAG,CAAC,CAAC;AACvD,IAAI,OAAO,CAAC,UAAA,GAAa,CAAC,gBAAgB,EAAE,OAAO,CAAC,UAAU,CAAC,CAAC,IAAI;AACpE,GAAG,CAAA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAA,uBAAA,GAAA,CAAA,OAAA,KAAA;AACA,EAAA,MAAA,YAAA,GAAA,EAAA;;AAEA,EAAA,IAAA,CAAA,OAAA,CAAA,uBAAA,EAAA,cAAA,EAAA;AACA,IAAA,YAAA,CAAA,IAAA,CAAA,oCAAA,CAAA;AACA;;AAEA,EAAA;AACA,IAAA,OAAA,CAAA,wBAAA,IAAA,IAAA;AACA,IAAA,OAAA,CAAA,wBAAA;AACA,IAAA,OAAA,CAAA,wBAAA,IAAA,IAAA;AACA,IAAA,OAAA,CAAA;AACA,IAAA;AACA,IAAA,YAAA,CAAA,IAAA,CAAA,4BAAA,CAAA;AACA;;AAEA,EAAA,OAAA,YAAA,CAAA,IAAA,CAAA,IAAA,CAAA;AACA,CAAA;;AAEA,SAAA,WAAA,CAAA,YAAA,EAAA;AACA,EAAA,OAAA,YAAA,CAAA,KAAA,CAAA,IAAA,CAAA,GAAA,CAAA,CAAA,IAAA,CAAA,IAAA,CAAA,KAAA,CAAA,GAAA,CAAA;AACA;;;;"}